## source environment variables specific to the machine before anything else
. $HOME/.pre-hook.zsh

## zmodload zsh/zprof ## profile startup time
## zgen reset && reloadZsh after each modification

# Uncomment the following line to disable bi-weekly auto-update checks.
# DISABLE_AUTO_UPDATE="true"

# use another custom folder than $ZSH/custom
ZSH_CUSTOM=$HOME/.zsh_custom

ZGEN_AUTOLOAD_COMPINIT=0

zsh_aws() {
    local aws_profile="$AWS_PROFILE"
    if [[ -n "$aws_profile" ]]; then
        echo "AWS:"$AWS_PROFILE
    fi
}

POWERLEVEL9K_CUSTOM_AWS="zsh_aws"

POWERLEVEL9K_LEFT_PROMPT_ELEMENTS=(status time dir vcs)
POWERLEVEL9K_RIGHT_PROMPT_ELEMENTS=(command_execution_time custom_aws virtualenv kubecontext)
POWERLEVEL9K_STATUS_VERBOSE=false
POWERLEVEL9K_SHORTEN_STRATEGY="truncate_middle"
POWERLEVEL9K_SHORTEN_DIR_LENGTH=3
POWERLEVEL9K_PROMPT_ON_NEWLINE=true
POWERLEVEL9K_MULTILINE_FIRST_PROMPT_PREFIX="┏"
POWERLEVEL9K_MULTILINE_LAST_PROMPT_PREFIX="┗▶ "

source "${HOME}/.zgen/zgen.zsh"

# if the init script doesn't exist
if ! zgen saved; then
  zgen oh-my-zsh
  zgen oh-my-zsh plugins/autojump
  zgen oh-my-zsh plugins/colored-man-pages
  zgen oh-my-zsh plugins/docker
  zgen oh-my-zsh plugins/docker-compose
  zgen oh-my-zsh plugins/git
  zgen oh-my-zsh plugins/golang
  zgen oh-my-zsh plugins/mvn
  zgen oh-my-zsh plugins/sudo
  zgen oh-my-zsh plugins/kubectl
  ## zgen oh-my-zsh plugins/aws #slow startup

  #theme
  zgen load bhilburn/powerlevel9k powerlevel9k

  #extra plugins
  zgen load djui/alias-tips
  zgen load zsh-users/zsh-syntax-highlighting
  zgen load zsh-users/zsh-history-substring-search
  zgen load zsh-users/zsh-autosuggestions

  # generate the init script from plugins above
  zgen save
fi

# Set keystrokes for substring searching
bindkey '^[[A' history-substring-search-up
bindkey '^[[B' history-substring-search-down

# override system python with brew python
if [ -d "/usr/local/opt/python/libexec/bin" ] ; then
    PATH="/usr/local/opt/python/libexec/bin:$PATH"
    #PATH="$HOME/Library/Python/3.6/bin:$PATH"
    PATH="$HOME/Library/Python/3.7/bin:$PATH"
fi

## Golang - https://sourabhbajaj.com/mac-setup/Go/README.html
export GOPATH=$HOME/devs/go-workspace
export GOROOT=/usr/local/opt/go/libexec
export PATH=$PATH:$GOPATH/bin
export PATH=$PATH:$GOROOT/bin

export ANDROIDTOOLSPATH=$HOME/Library/Android/sdk/platform-tools
export PATH=$PATH:$ANDROIDTOOLSPATH

## Custom binaries
export PATH=$PATH:$HOME/bin

## zprof ## profile startup time
